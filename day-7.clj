(ns advent-of-code-2017.day-7
  (:require [clojure.string :as str]
            [clojure.set :as set]
            [advent-of-code-2017.core :as core]))

(def input
  "nzyiue (57)\npdmkag (39)\nbogbg (13)\nnubay (45)\ndukzh (17)\nkpjxln (44) -> dzzbvkv, gzdxgvj, wsocb, jidxg\ncxjyxl (83)\nvusplt (151) -> mcfst, orrwx\nmxrfq (98)\nbdoez (62)\nvrajpg (78)\nqzsowpu (90)\nnrxoha (51)\nxtjrkv (351) -> jlbhafs, pyocxtt\nrlnii (18986) -> xjosf, ljvpv, wkumzkr\nddrrgp (23)\nwladmn (42)\nryskzh (209) -> wsyya, xbqpjo\njbjkp (34)\nfnfiur (86)\nzxzkl (82)\nhbmxey (1869) -> khkuxc, mjuwde, tztycfl, miauii\nzjyqcfa (97)\nzbtck (48)\nmgsasl (39)\ncemygp (34)\niolrkmv (139) -> rntjx, itxtmhb\njzmqzl (1446) -> pptocz, mwfryd, utgkveb, sflwom\nwagpkyw (88)\nsaiyjff (67)\nkwwhb (219) -> htvpmr, rojhup\nhuspq (74)\nmzrafi (44)\nfchlc (89)\nezkddph (62)\nzehnmg (5)\ntgirh (50)\nxantdh (73)\nzicvvl (10)\nkcimi (86) -> uwizfa, kmhyz, wagpkyw, iuovz\nwsocb (64)\naemffo (284) -> dukzh, vczudlu, tpubu\ngfgoc (18)\nbmovg (80)\ntrsnrjd (89) -> oujkd, fstzdn\nbmqiwai (12928) -> yqeaqcn, cgzyc, bwgkn, giftd, hdhvzi\nktehtif (151) -> fvplhrm, jesphm\njkfyg (76) -> ajeisgv, jfrooen, hvhtokr\ndkfepj (1970) -> tgirh, mnsqjxv\njjseenh (99)\njvpecm (7) -> dpyuayl, lyigbhi, bflxonp, tvcyh, tddik\nsilklk (59)\nswscfel (68)\ndilefzx (89)\nspthyf (75)\ntiiwbg (17)\nayqgp (58)\nqhygx (14)\nhqccsb (26) -> bdkfx, srrxb\nlbojqfo (34)\narbebt (32)\nfsvkj (115) -> ftqtzxk, twzgms, otvvje\nsdigtox (39)\nawsphe (79)\nlftlc (35)\napzabs (68)\naboilvw (452)\nrntylx (44)\nxhhfsuw (280)\nyucwtc (41)\nqlgkqk (54) -> sqfrw, acdkw, ycinfxk, wcinck, hyfswg\nthneyz (57)\npplkoa (79)\nvsxzpf (197) -> spyxh, yvcbk, fkmccg\nmiymiit (1002) -> lmmeg, jxulvx, yqergs\njaamgi (45)\ntvwosmc (1462) -> frvmu, qmfmfxh, jemmk\nngemsu (85)\nohiftl (143) -> loggp, xhwfcu\nbztor (157) -> gjfkx, grsdifs, spchmoq\ntifkr (52)\nkgctcau (82)\nyvcbk (32)\nsrvwd (1234) -> dxerl, pzjsf, yqyyoj\nxrise (358)\nbiwdu (70) -> kvpju, hlullj, bfpvsfz, fvfitqc\nutgkveb (76) -> fmhjs, pplkoa, mznkfco\nmvhqou (22) -> njgzn, okfcek, zjyqcfa, culvtcm\ngadyi (398) -> ndxim, efwhif\nujzofuy (39)\njjgem (852) -> hnvybq, gnffzh, fbuklc\nrbucosf (122) -> jvpgl, yuhioxl\nffxnegs (222) -> zfcylzq, xjxjaq, cocau, vusplt, cjlxgf, yjonn, iazte\nwrtyhxg (403) -> zqckoxe, vindf, jbvugg, idivffq\nimbpvgl (52)\nfrrvvai (193) -> gxcnp, zvjrwke\nywlrls (31) -> gqdxrur, dfyqo, cxndroi, gbpcav\nolzdhtj (42)\nthvjlgo (76) -> cufudi, jdyspx\njearhat (57)\njxanwhq (27)\nwsyya (98)\ntahstqe (37)\ndyvooj (80)\nyuypmb (98)\nuehdbi (26)\ninspqeu (34)\nnxqqsza (119) -> guxwd, iyxkzat\njgkmy (86)\nhllzej (154) -> sodrm, ekfpabq, utqxb\ngcbvf (68)\nctoxz (98)\nadvlxrg (22)\neetxll (37)\nlmpauyz (72)\nlwxts (76)\nrkuyxrc (55)\npitdti (55)\nucjew (91)\ngynwftf (91)\nczojwyg (15)\nuigoxw (75)\nrcjqfuo (129) -> lgoak, zcomcn\nvvkbav (56)\nnpcyutn (35)\njfaoy (57)\niqcgwzk (58) -> pdepl, zxeopkg, dukqd, gxdtiob, ylnvdoq\nrqnsxm (2056) -> jaxig, bolxwme, dgsse\nbsyiv (38)\nhhnpg (164) -> dmvajb, pvwdkm\noydoajo (87)\nfowpeur (85)\nycnih (17)\nzwpyj (12)\nwpprf (97) -> fdthu, sxslizl\nicqsww (55)\nckedyqu (54)\nageyuq (19)\nebrgtq (112) -> bochc, wqdvql, ogafygg\nygteuy (89)\ntuhxr (76)\nrvuvico (91)\necjujqu (92)\ntvhgbau (79)\nzvsnz (26)\nfquywyi (308)\ngqrgh (24)\nzcfswa (37)\nhkbxj (55)\ncnknlru (70) -> udfuty, sawqp\njljnags (38)\ntztycfl (939) -> rrtqyew, gqzemw, hsfxq\nxzyri (187) -> yakzm, zkikhk\nsdzoy (51)\nojtrl (130) -> hpgktb, pjkwlmk, phkvcix, zguqo\nlyhok (95) -> hdpemqh, nfvsrpa, bwthm, bilzbf, nrlvovz, iqcgwzk, sljgt\nhpanc (17)\nykvtr (51)\nqbbmsf (97)\nppfyonm (98) -> ylwniqh, ecjrblb\njdsdqzd (32)\noujkd (97)\ndpija (23)\npdjnnzd (85)\nghzqyv (37)\nyvlxoom (58) -> yxoqwg, wgwkss\ngjupqe (180) -> oszyw, zyqqzou\nqmfmfxh (7) -> rkgxu, unrhnl\nhxlefwp (268) -> yablonq, ouxjkf\nfdthu (86)\nvoonmio (63)\nuxlcvt (143) -> scipnb, veutu\nxybcccw (7)\ninomnjg (91)\ngfuxooq (221) -> aceiy, axtzeb\nxirqz (71)\ntuqzsn (73) -> hueqfk, hcyohc, nerlvh\njaxig (82) -> llofnny, snvqyqb\nczztmlk (61)\nffrilz (148) -> qnvzqc, ckedyqu\nejslpy (5616) -> wwcih, jzdmjdf, gnrqrsj, ayirpk, kvifa, bapvub\nbfwbkxq (493) -> hiqhe, ouqwmnj, wqxcn, jkfyg\nupftju (48)\nbqcizg (67)\nmkyqul (5)\nwjjar (296) -> ywutc, nsvrfae\npabgfh (244) -> bogbg, hgcxyx, siisskc\noltky (7)\naeapmwq (76)\nbtjxv (35) -> wpgyc, ripmztc\nonuxzz (247)\nahayh (54732) -> byrvfhp, rokie, ejslpy\nidooz (192) -> owxuzp, uehdbi\nghjpcv (162) -> xucdiz, ygrbgm, yxqesmi, ebktv\nzhffrzu (42)\nbpygf (26)\ntojpm (42)\niihzs (67) -> hkbxj, enekg\nydpihb (46)\nrgssc (27)\ndkgsvl (82)\nqrfhxne (65)\nsntuz (68)\noznhe (98) -> tgvdjhh, cpvlq\nevfqyvl (304)\nqftqq (27)\nyxcbn (11)\nbuifcn (15)\nxbpqmua (25)\nvjroix (85)\nevqrr (48)\nunrhnl (88)\nihuzl (35)\ngiftd (1250) -> zbedu, vyaoad, qcolnc\nuqjmbb (17)\negulpbe (80)\nfpmwz (218)\nnihmyu (98)\navaoo (176) -> xxshup, xsufhnb\nfmqon (61)\nmbokr (57)\ngprznw (41)\nbflxonp (105) -> pdmsm, jearhat\noylgfzb (65) -> rugzyaj, hbgyu, rlnii, gwznzk, bmqiwai\ncepqh (19)\nhfjhadi (58)\najtkddh (60)\nvyadxnv (94) -> pyntdrr, mdpcfvu, cbvjwlo, ijleirw, sltrdk, adueu, qlkqplv\nanvvug (1847) -> tfuxhhz, kgctcau\ntjobe (129) -> hdspavt, mcduq\nqvgeei (273)\ndkxsqjt (1416) -> cuwqi, fcoxtp, yvlxoom\nurwgjd (39)\nvxqcf (105) -> gfnapwr, lmpauyz\netnkepp (5)\nkoyke (15)\nqqhjlu (78)\nglguoq (75)\nhdvfyp (7) -> eoaprcr, cksyln, hknzmvs\npqvid (15)\njesphm (6)\nbdkfx (81)\ngqdxrur (77)\nfmifd (94)\nijiqjtf (63)\ndfyqo (77)\nspchmoq (31)\ntvcyh (149) -> lqbtnb, matcdld\nilzwrk (64)\ntdtznh (64) -> phacwjs, offas\ntygst (91)\nuzjoys (198) -> bgcjrf, zdrfiw\nwfbuzbg (47) -> qpuyqq, ajrcal\nkwqcbe (19)\nqdovgra (303) -> zziyhz, gfgoc\nvfcbliu (19)\nfwtfkp (325)\nrmdqvgh (61)\ndtjzr (28)\ncocau (77) -> ficmghd, nkejtw, qowyx\naftsom (70)\nfsmzljm (123) -> tatjry, hnfeims\nlwufmc (45)\nfzzcxvm (61)\ncxokosi (70) -> sszzop, gatdr\nmmlra (32) -> wdlwryo, wpprf, jexreg, lzowumq, rcjqfuo, lhnevgo, smuybnw\ntydlqpq (160) -> fsbojm, mjlmuca\noevvote (68) -> silklk, polrzc, erysec, xoyjtol\nfxsatsm (83) -> sntuz, qgxcbt\ncvvtz (80) -> vpjhl, rgssc\nfeonsg (74)\nhtvpmr (7)\ngqzemw (43) -> pxdgkik, jtvntr\npvpqoq (17)\nldfmurk (88) -> fubtwbq, ycawl, sqsqge, aemffo, mszwp\naufym (51)\nldflo (188)\nizyjved (5)\nzgydn (72)\ncqfri (9)\nytnti (150) -> lamtp, fugeht\nappkqpe (95)\nsjxbk (117) -> tinbqcj, amwtic\nfbvvrqt (81)\nvlwjehz (22)\nlwhev (44) -> zesvlul, wmwzhjg, hpjgrb, sxbusu\nhugfkt (42)\ntnobvt (18)\nzesvlul (73)\ngfnapwr (72)\ntabzzo (62) -> rvuvico, inomnjg\nixdcgsa (177) -> gmhxee, cogovv\nfnvgp (85)\nawhwxdm (91)\nfrgot (59)\nboete (78) -> ionnnfx, vytdgko, ouhfxyf\nikxewmm (14)\nqfkka (49)\nxidye (11)\nkrdlzf (115)\nhxjhcuc (694) -> miuvc, iolrkmv, trsnrjd\nikbkb (136) -> uigoxw, spthyf\nyqeaqcn (53) -> qysdgq, mkjvhl, evfqyvl, bhzbv, usuujhq, hxlefwp\ndnrxyh (887) -> xthhlfy, fxsatsm, cqpns, xzyri\nsiswh (41)\npfxrf (51)\ndlzgufq (7462) -> ldfmurk, dnrxyh, dzetsz\nwhlfwr (46)\ngbiluq (11)\neuaceg (42)\niwdesog (152) -> cqyluwl, dbeskg\nafjmzb (15)\nsofxmjx (83)\nortcrq (18)\nphacwjs (58)\nuiwgpi (995) -> hqvvrd, caihc, rvxed\noiyxr (86) -> zibbm, sbklnq\nyukoxaw (27)\norrwx (47)\ntlxbtng (44)\nayirpk (1850) -> cdkcn, wbllfh, xounvb\nlqjznss (67)\nmldkiku (55)\ndyfhy (58)\njxulvx (34) -> ujzjt, ykmej\nyuhioxl (20)\nuwiza (106) -> lddiw, hxaza, bnvjmae, oltky\nhpsxqdm (41) -> luzcpkn, azdklp, rupdbwl, vwqog\nfubtwbq (211) -> bdoez, ezkddph\ncwgbjaq (41)\nkmhyz (88)\ntpubu (17)\nbfrbwb (27)\nmgwauar (8)\nixwyi (13)\nljugvh (7) -> nxrkz, gnwjseo, ibjbozh, iaiywwa, pcdtne, nvtbk, vobfi\nrcongvf (20)\ncsqyn (46)\nygbyt (15)\ngwznzk (11) -> ehqavsc, yimottm, heuyaxx, yirkbjn, fqhag, ovqhdvy, zzxlo\nwwcih (1585) -> dyveac, pejho, cyfuwdb, tojnst\nalqog (157) -> dyvooj, wvkaie\nqecgvu (19)\njexreg (209) -> bonnse, phgkg\nvbisx (49)\nbcukkvc (72)\ntrcbs (90)\nxjxjaq (211) -> kfhwxyy, vnmxsi\nuptgby (16) -> eocoy, lqjznss, petluuh\nrjnht (63)\nurhwog (146) -> mxscf, fwqru\ncaihc (158) -> kzjkjz, rjijdre\nmwjtydb (15)\neqahcc (73)\nrntjx (72)\nripmztc (96)\ncksyln (93)\nktfeae (20) -> asoirn, jbxnffu, feonsg\nbdukt (71)\njtxbfm (55)\nebwtpod (66)\nfjerhwe (50)\nxxshup (66)\njdyspx (97)\nnyxiai (73) -> pjmci, ejvaoj, fbiqxqk\ndxznun (49)\numwial (183)\nmnsqjxv (50)\nwtoive (80) -> nfcru, goicjt\nzkzefwh (22)\noszyw (78)\nekxdjlp (60)\ntymor (6)\njbydxyp (66)\ndzlqgrt (43)\ngrsdifs (31)\npdepl (238) -> ulezwmd, fhlul\nmbunh (8)\niwajy (70)\nlknchr (68) -> nercz, skmvkj\nklpctiz (75)\nlazlx (8)\nfbuhz (159) -> aarioi, fbrvfk\nkvifa (69) -> fquywyi, ndmcgpn, vczcept, rjhfcl, jatvkwy, fodud, avaoo\nilydn (74)\nnerlvh (85)\nqqduoo (735) -> wgglzpb, tcrkcu, boete\ngfxnuuk (34)\namwtic (72)\nltpban (87)\nklyso (67) -> qenjyl, egabi, hmdwqdq\njotxc (57)\ncqyluwl (9)\nsiyuvy (52)\nbbsomm (61) -> izonhi, jjseenh\npzjsf (49) -> etnuzv, hrrampl\nvshekb (34)\nzvjrwke (27)\nxekggcw (89) -> tvwosmc, dpfov, anvvug, fneqe\nhsulvq (78)\nidivffq (292)\nbapvub (821) -> acnvtg, lvkpx, zeopgv, dcpnyer\nziwkz (331) -> eqzuic, qrtwjv\nbvock (81)\nvsyuckp (54)\nbsoef (40)\nncjhpa (247)\naxtzeb (13)\nyotlucw (134) -> jbydxyp, ebwtpod\nceqfbbl (33)\nqhbotj (62)\nhrmpq (90)\npgznzly (13)\nvgndgst (72)\nauvla (65)\nylnvdoq (350)\nfgxst (8)\npptocz (287) -> werriw, hglhjt\nlqbtnb (35)\nxvuri (293)\ndbeskg (9)\ncrkapwa (87) -> ogpka, npdwg\nbilzbf (803) -> brkux, qcoyrha, cplvif\nbyrvfhp (80) -> gqgewi, csear, vyadxnv, rqnsxm, cgjula, luuxtc, jzmqzl\ncqiipxn (84)\noryrq (103) -> cabsaub, zfthi, palqky\ngkzeqaw (38) -> iyflfx, hntdp\nxqnrp (33)\nzcomcn (70)\ntjcpka (87)\nnfcru (41)\nvfpdqlb (43)\nmsdff (82)\ntddik (43) -> vlthh, btbses\nqlmojkv (264) -> tymor, xkfuzi, ligpl\nsodrm (37)\nmvvgro (84)\ncbvjwlo (270) -> nsqzndf, synjm\nkowco (46) -> gqrgh, nhxmab\nxrapmvb (150)\niifltp (95) -> fowpeur, vjroix\ntinbqcj (72)\nlbjuqcd (19)\nhlhomy (30) -> oylgfzb, ahayh, razvskj, hvtvcpz, teyrfjn, lqirhg, dxxty\nveutu (53)\ntfuxhhz (82)\noenrkia (44)\noipjwtz (40) -> tgqpp, mjbjv\nndcjr (75)\noermd (94)\nxsmgj (99)\ncfmhi (107) -> obrwb, hoelsa\nnwyftp (72)\nnmdhmy (39)\nqslgo (92)\nmjbjv (89)\nhhvqa (41)\nerysec (59)\nxdnuvji (20)\nbfxezgb (8)\nnjmrq (192) -> uufrda, pdmkag\ngutukz (70)\nacjtwvt (98)\nkddchk (71)\napzjw (149) -> jetfvjc, peomyg\nxzhvvy (431) -> ehxkgh, alcpfsx, kvjqli, tjdap\nsowzlz (19)\nucvgxii (85)\nuzprmq (83) -> ygteuy, exhxs, pfzqe\nbvaor (35)\ngekcx (78)\ncxlip (44)\npsnkhtd (157)\nyimottm (2101) -> fsmzljm, uptgby, tvhfxfo, ickxyrm, nxqqsza\nocbxx (66)\nacnvtg (277) -> wbbfe, nchjk\nvangx (51) -> xobyzo, jdhiflw\nsfoivjz (17)\nlunbob (66)\necabcm (190) -> vlwjehz, advlxrg\nqarjx (7)\ngyktq (98)\nimfog (52)\nzsdvfrk (1190) -> vxqcf, fvivhx, oxyxy\nzssgj (44)\nefbffd (20)\netdofb (62)\njuakl (67)\niltti (60)\nffgoyk (74) -> jgdumgz, ltpban\nlamtp (89)\nloggp (75)\npejho (106) -> mqaajk, tnobvt, gxhia\nenekg (55)\ncplvif (95) -> xfanpad, uhepxt, lebqr, hqipq\ndgsse (88) -> nwztmzp, akrgdse\nrwjzc (107) -> qrfhxne, lcufpmj, paqlttl\ndrszzbe (132) -> ucjew, unfgdb, tokvgmd\nvtnpx (79)\nrrkhcl (26) -> seazs, koemv, qnxnatu\nekfpabq (37)\npwvmmda (278) -> rntylx, hrkswsk, zssgj\nvqekr (85)\nluccp (175) -> ebrgtq, rvuktmb, pslyfi\nxkfuzi (6)\nobaorae (45)\ndpfov (96) -> roqnodm, adasbyp, uorpbn, zyonam, zjcdwr\nlzowumq (41) -> sjthmr, mtboq, aeapmwq\npynxen (152) -> omzpkv, rwuxn, dpija, xgogpx\nitxtmhb (72)\nhanbscg (21) -> npsza, jdjaem, lvuzab, fffxc\nteyrfjn (62414) -> ilfgats, qlgkqk, vyvcb, rnsxz\npocxfrt (39)\nmqecf (76)\ncpacyeu (67)\ngycde (88)\ntlhgrte (2388) -> xijwk, mmlra, ejtoqaj\njumdfk (64)\nswsffrv (13)\nfujvp (155) -> gwxkdy, hsftfol\ndyxcd (87)\nljvpv (452) -> huutnfp, hoauxku, euvkg\nxydxl (88)\nibdiplp (20)\nxvwqzt (70) -> ppdsem, pyhqixj, rjnht\ndjmoed (90)\nraioiq (134) -> ipdbccy, inspqeu\nbwywt (67)\njfvquxv (70)\nmtxzcd (282) -> ucvgxii, ngemsu\nlfgmv (87)\nlcufpmj (65)\npvwdkm (50)\ndbnstqf (56)\njwgjnuu (33)\nndmcgpn (256) -> zvsnz, bpygf\nrktkzfw (35)\nzxeopkg (218) -> yjyipdp, drnyyes\nnutlr (116) -> ybuhf, fjerhwe, xmrcq\ncdkcn (39) -> dzlqgrt, vfpdqlb\njfrooen (95)\nxmrcq (50)\nqpuyqq (83)\nhiqhe (361)\nxuxlspe (44)\napvfi (59)\nwahwi (303) -> lnnii, boxvu\naffxphr (22)\nlhtzrh (213)\nyeewxiw (50)\nzyxjqs (65)\nkqgqdyg (69) -> yqctq, tcihaf\nsqnfwo (67)\nmbqkm (12)\nmqaajk (18)\nnxhetg (60)\nhrxfpx (65)\nwjfsiec (19) -> znpqzc, xvuri, vsxzpf, doazn, tjbyhjw, czxbmp, vqqrb\nhsfxq (99) -> jtxbfm, lzhdsyq\nlbiigt (26)\nbwgkn (1005) -> uzily, urxxlfo, yqnbqgc, cgnibii\nhpjgrb (73)\najpcyv (42)\npirivl (144) -> bmovg, yexyj\nszuiho (73)\nlnhiiq (64)\nyacaqwf (82)\nnqcadtp (310) -> kzvwk, akatbi, gncvcwi\nbvgfpab (15)\ncxndroi (77)\nefwhif (6)\nnjkxyjn (12)\nkvpju (39)\ngyyqk (5845) -> jeshqdv, xzhvvy, ynwpoz, jtlhia, gzykr, coyroy, tqjpfzx\njwpqgy (168) -> jxanwhq, fsixon, lnsyuz\njwxff (95) -> ihtomiz, xeprhhl\nyycux (15)\nfmhjs (79)\nwvieaw (67)\niancjuu (39)\nvczcept (112) -> muavtro, ipeig\nmwtusu (81)\nmoewgvz (89)\ngmfktbe (31)\ndcpnyer (67) -> fmjyudw, wuhyc, icccxzg, nufpcxh\nhnfeims (47)\nrouiui (30) -> tqlentr, zdkil, veqahi, txnzg, euiig, qlmojkv\nbppos (37)\nhoauxku (219)\nficmghd (56)\nlxpshey (95)\nhglhjt (13)\noqbet (58)\nbsmxm (88) -> trcbs, ewsrnsd, qzsowpu\ndxerl (79) -> kdujkg, njkxyjn\ngxhia (18)\neqifs (3869) -> aqjkcss, uiwgpi, cmeqx, jwlaj\nhqipq (60)\nupbmqk (18)\nculvtcm (97)\ncgdbu (90)\ntnrpi (241) -> zjtid, xybcccw\nhlullj (39)\nihcbt (44)\nwfjgqqm (55)\ndmzwm (86)\nhvtvcpz (81171) -> dxcpj, eqifs, mdfbhs\nuufrda (39)\nlsfdgam (77)\nhuutnfp (57) -> blrzef, ihllda\nvnmxsi (17)\ntjbyhjw (161) -> ihcbt, tlxbtng, cxlip\nfshvy (84) -> indgw, gynwftf\nagsjzih (10)\nppdsem (63)\nskmvkj (33)\noxyxy (205) -> aawxzzs, tdnzc\nywavdk (67)\npkxhxdz (70) -> gklur, vqekr, fnvgp\nxsufhnb (66)\nouhfxyf (97)\ndukqd (50) -> opyzwha, sfxsn, ndcjr, uystf\nzybvpry (20)\nwwobe (34)\nbolxwme (74) -> jfvquxv, rsqexkv\nadhilml (299) -> cqfri, mhassfj\nicrnru (160) -> gutukz, fuega\noagluxi (40)\nligpl (6)\nfttsg (255) -> gmfktbe, ebtbnei\nihtomiz (99)\ngblxcsj (251) -> kuaeh, pmfpitp\nlrvxyg (91) -> lfgmv, ohtzuf\nwuhyc (71)\nqjuud (160) -> ckexdc, oencfz\njbfzjha (305) -> vbmhjxo, txvuv, mkyqul, zehnmg\nxjosf (89) -> dfdgoj, xagwh, xkpulvc, tnrpi\nzkcwgx (22)\nilbopwx (87)\nakatbi (222) -> qjazr, pizkx\nuxuscb (249) -> jpeprwv, mdrir\nhbgyu (19007) -> nqcadtp, tkeoe, jvpecm\nkjzsi (56)\ncduzde (13)\nedoftkj (84)\nlxisjl (86) -> euqvd, hugfkt\nowxuzp (26)\nnalhhj (4471) -> dkfepj, wjfsiec, egrga, dkxsqjt\nvcaekf (67)\nevwne (21) -> czztmlk, fmqon, fzzcxvm, rmdqvgh\ncrojfnw (171)\nupiow (82) -> hukskkk, ilbopwx\nsrgua (120) -> koyke, hvefi\nrcywun (81) -> moewgvz, fchlc\nqlkqplv (138) -> hsulvq, ghuoa, ozwaa\nczxbmp (197) -> ieeqmzl, yzivqv, arbebt\njjmyu (80)\ncyfuwdb (40) -> mywmo, nppdvs, fwafvkf\nhmdwqdq (79)\noencfz (10)\npjkjcy (20)\nsxxhmpb (8)\nuwpwbgy (213) -> gbiluq, xidye\nmywmo (40)\nrbmmiy (833) -> rwbhl, vtono, shkfk, umwial\ndmvajb (50)\nsmuybnw (89) -> uktqwa, vdistyb\nuagezb (984) -> hdvfyp, kwtukd, ikbkb\nnrlvovz (840) -> qoipc, oznhe, uvhmzj, kebff\nvbmhjxo (5)\nckafg (86)\novqhdvy (2715) -> psnkhtd, zxqix, trnjhsl\nuktqwa (90)\nlzhdsyq (55)\nkofvzz (66)\nmcduq (60)\nqnsnc (62)\nkwtukd (232) -> nhzmidl, bfrbwb\nzzavd (13)\nfmjyudw (71)\nvcnph (161) -> wqgpm, nnvpkf\nlgamzp (64)\nukqcayx (92)\ndiduy (116) -> xwphya, msdff\nizonhi (99)\njetfvjc (16)\nrjhfcl (308)\nvqqrb (179) -> jfaoy, jhgxtg\ntulxdf (308) -> bcukkvc, zgydn\nrxuqpgb (144) -> aqogxi, aicncxc\nspyxh (32)\nyqergs (100) -> kitsxb, woeoaa\nbthswyg (34)\nrfaxua (81) -> zugxr, dtyxosg\nfcoxtp (42) -> aqqdnpb, nkgmg\njbxnffu (74)\nbwthm (929) -> jwxff, ohiftl, aqtml\nionnnfx (97)\nurigx (141) -> xsmgj, eyozeel\nnsggol (249)\nmgeseyn (267) -> hvacjk, pvgay\neqzuic (37)\npxdgkik (83)\nzjqbfd (188) -> viklkmp, vfcbliu\nwivwqm (74)\nnowyhln (52)\nsqsqge (219) -> amaeuv, paqvyfa\nvynvu (87)\novysqnt (86)\nbrfocu (230) -> zicvvl, zbhahq, agsjzih, ydhfmt\ndgumiir (40) -> olzdhtj, inezd, kqrjpgl\nvpjhl (27)\naqqdnpb (88)\nqaszsa (94)\najeisgv (95)\naoscme (73)\nowlyge (65)\nkdqslsn (73)\nhukskkk (87)\nvindf (73) -> szuiho, aoscme, fbdfh\nkosxb (140) -> tcpujhx, itlsv\noeaqbvl (142) -> bsyiv, fiqzxhc\nlyigbhi (105) -> pqmye, nzyiue\ntrnjhsl (73) -> iinql, yhzwdu, dtjzr\nmkucbvs (138) -> ikxewmm, qhygx\nfvplhrm (6)\nqnvzqc (54)\njdbub (48)\nopyzwha (75)\nxeprhhl (99)\nxounvb (101) -> mbqkm, zwpyj\naswpgvv (42)\nrazvskj (60626) -> dlzgufq, xwifd, nalhhj, lyhok\nygrbgm (172)\ntcrkcu (329) -> ibdiplp, efbffd\nmijxl (63)\najfkd (9)\naaaak (6) -> mdopg, mzrafi\nqgnah (42)\nemppnct (78)\nqysdgq (154) -> uutlw, klpctiz\nhkewsbw (89)\nlcfundi (52)\niccpjfn (92)\nmodzqb (30)\nnsqzndf (51)\ndpyuayl (18) -> wvieaw, cpacyeu, hwkwp\neocoy (67)\nfbuklc (82) -> lcyuk, klzfl\nieeqmzl (32)\nqcoyrha (255) -> kjqiop, oagluxi\nlbfgh (123) -> obaorae, yktqkyl\npayoa (194) -> khbvu, nrxoha\nywutc (71)\nfodud (178) -> axmjgih, auvla\nactggv (65)\njngcap (845) -> tydlqpq, ebdxuo, ktfeae\nhcgbmwl (60)\nlqirhg (70965) -> hbmxey, tlhgrte, xekggcw, lxffhxk, knhst\nifntl (26) -> emfbheo, heicvby, vcnph, qvgeei, gcylwr, uxuscb, ubrrbmk\nuiasar (15)\nsfkzoax (46)\nbqtppn (236) -> xqnrp, fsguvid\npeomyg (16)\nsqincn (80)\nzjtid (7)\ncpvlq (72)\nnwbmwa (17)\nyjonn (185) -> rbhdx, cbnef, bvgfpab, czojwyg\njafdtcn (79)\nuqofam (245) -> lxpshey, qwdppks\nnkejtw (56)\ntcihaf (28)\njwkgg (17)\nhsftfol (46)\nehqavsc (22) -> aboilvw, diavsdh, nuybvi, ziyyvk, wyule, mtxzcd, tulxdf\ndyveac (96) -> jdsdqzd, lhmjc\nyfztc (74)\nnuybvi (452)\nymfosm (38) -> hdkpuyx, ckafg, dmzwm\nvrjea (1809) -> stcaf, hemnmbr, zuxvjpc\nqteruty (8) -> mwtusu, pvpyhb\ncpmcrx (13)\nouxjkf (18)\nrvuktmb (147) -> yhlbg, cwgbjaq\nblrzef (81)\nguxwd (49)\nyyyqzje (225) -> fnfiur, jfngjl\nqbkipp (92)\nwdlwryo (149) -> nxhetg, iltti\ntjdap (240)\nudxegjf (44) -> lzbbin, atfpsi, tuqzsn, ytnti, zdade, skotajh\naeliqqs (26)\nshkfk (183)\nadueu (372)\nzbhahq (10)\njbtzoy (80)\npkcakwk (300)\nhwkwp (67)\ngatxz (45)\nqizvid (38)\ncbqebx (152) -> ornybn, zcfswa\nppmjzx (267) -> whlfwr, sfkzoax, csqyn\nrwuxn (23)\npcdtne (6) -> fbuhz, alqog, hanbscg, fttsg, gblxcsj, cujhtj, adhilml\nfvfitqc (39)\nrgfur (104) -> aswpgvv, qgnah\njhgxtg (57)\npkotpki (86)\nujzjt (92)\nzkikhk (16)\nskotajh (328)\nycinfxk (1450) -> kosxb, cwvkon, nyxiai, bztor\ngnffzh (234) -> tiiwbg, sfoivjz\njuvwj (79)\nckcaugr (62) -> zebdkqz, xuxlspe\ngjfkx (31)\nblome (73) -> jjmyu, bljfcim\nyqctq (28)\ngpzaa (68) -> sqfopc, lxxfgli, yyyqzje, cjkoxak\nqoipc (68) -> tjcpka, oydoajo\nolhuxt (7)\nzdade (166) -> oyfob, bvock\nihllda (81)\nsbklnq (85)\nyyblsz (54) -> nrmvc, dszjyr, bppos, tahstqe\nqenjyl (79)\nzukgdrx (79)\nfszrgv (34)\nulezwmd (56)\nxgogpx (23)\ngwxkdy (46)\nknhst (5583) -> ghjpcv, szvrql, ojtrl\nmblvffb (79)\nqowyx (56)\nyablonq (18)\nmwfryd (93) -> mldkiku, sveuu, kzjfme, kzwbhrg\nxjafd (17)\nnjgzn (97)\njpeprwv (12)\nlnnii (18)\ntsetywu (22)\ngdutjjl (73)\nlnsyuz (27)\nqyypm (417) -> uqofam, xtvyh, ajpujs\nuutlw (75)\ncbnef (15)\ngikqie (90) -> qpwfl, pxhbe, yxcbn, lftlpr\nnkuesm (60)\nznpqzc (53) -> ekxdjlp, skvytv, nkuesm, ajtkddh\nmszwp (53) -> qaszsa, tupro, otljqmh\nstcaf (54) -> cufaveh, foblbqu\nnmlykny (112) -> uitef, lsfdgam\nfrlmoih (92)\nhqvvrd (34) -> juvwj, ayafxml\nunzzng (22)\nxucelzn (49) -> jumdfk, ilzwrk\nnyjmiyq (91)\nzfjpii (181) -> btjxv, rfhjgxy, digfyo\nvyvcb (4479) -> jsniger, rbmmiy, zvildgh, kvtvmi, ogiie\nfwqru (62)\nskvytv (60)\nujogppt (95)\nmgzotal (125) -> frgot, sjcbxp\nytpiey (83)\nbfqba (872) -> vopeoj, gfknji, iwdesog, qteruty, lxisjl\nfoblbqu (20)\nbzlgar (37)\ndszjyr (37)\nnrpyfqd (39) -> nihmyu, acjtwvt\nvgvvr (66)\nhzsgvc (8)\nlddiw (7)\nydhfmt (10)\nuspvnv (94)\nseazs (92)\nzrydf (108) -> zzavd, ppbevc\npkglsge (93)\noamrbi (33)\nbendlfs (92)\nrkgxu (88)\nfqhag (2673) -> vangx, crojfnw, njrzjdt\nwesyh (26)\njbaazop (19)\ntgvdjhh (72)\nebdxuo (242)\nxthhlfy (61) -> jafdtcn, kbout\nvlthh (88)\nsqfrw (830) -> ppmjzx, vixlf, ryskzh, ynkkomw\nkzjfme (55)\nheicvby (145) -> akrsjfc, lnhiiq\ncuaect (114) -> ftdkas, jwgjnuu\noyjtku (93)\neyozeel (99)\nrfhjgxy (227)\neoasnfq (94) -> idszh, vshekb\nphgkg (30)\ndxgnqsj (34)\negrga (1130) -> nrpyfqd, cfmhi, uwpwbgy, zqtok\nsljgt (1013) -> iifltp, igfjvkm, rxefab\nbszcup (56)\nkkyfjh (83)\nfrvmu (143) -> xdnuvji, vwhynu\nfsbojm (41)\nmavbgo (91)\ndigfyo (188) -> tkejpfe, ynirne, swsffrv\nxoyjtol (59)\nqvbuj (1045) -> dgumiir, ofnmnyy, mkucbvs\ndzetsz (1418) -> nsbli, ulxsa, krdlzf\nzguqo (92) -> ripgc, oenrkia\nklgsk (6)\nyktqkyl (45)\njhcurc (50)\nteuzi (57)\ngfknji (26) -> nwyftp, vgndgst\ngcylwr (221) -> wesyh, lsycscb\nhxaza (7)\nasoirn (74)\nofnmnyy (36) -> sziwpzi, zyxjqs\nxobyzo (60)\nazdklp (43)\nmcfst (47)\nvwqog (43)\ntupro (94)\nlytukj (25)\nroqnodm (92) -> qbbmsf, oxewutr, pdcaqbr\naxmjgih (65)\nezztp (87)\nluuxtc (2600) -> qfkka, dxznun\npvzyops (94) -> oiyxr, ffrilz, upiow\nadasbyp (237) -> kdqslsn, xantdh\niaiywwa (1850) -> nhxfu, boiic, kqgqdyg\nzdkil (214) -> cemygp, bgctgn\npslyfi (7) -> ilydn, birahww, yfztc\nwbllfh (43) -> xwmnaj, gprznw\ndrnyyes (66)\ncoyroy (175) -> oevvote, zzwtuu, klyso, pirivl\nddkgzi (19)\nbtbses (88)\nmhassfj (9)\nrbhdx (15)\nkfhwxyy (17)\nozwaa (78)\nlhmjc (32)\nlftlpr (11)\nncaoc (58)\nzacywmu (12)\nvixlf (45) -> cgdbu, djmoed, npfkpts, eisrj\nvwtmps (142) -> jljnags, qizvid\nfsguvid (33)\ngxdtiob (203) -> vbisx, gzter, bzkwsro\nxwphya (82)\njtujnwo (37)\nwyule (401) -> nwbmwa, pvpqoq, jwkgg\nwpgyc (96)\njbvugg (224) -> dxgnqsj, fsfuluo\ntojnst (160)\njeshqdv (1303) -> affxphr, lyhxuh, zkcwgx, cqdtav\nicncbl (48)\nkqiraxg (54)\naicncxc (29)\nzbedu (209)\npdmsm (57)\nkictlpo (37)\nbrkux (335)\nzrbkrdx (41)\notljqmh (94)\nkcreb (48) -> ihuzl, bvaor, popymuq\nmuavtro (98)\nayypg (56)\nvdistyb (90)\neuvkg (203) -> mgwauar, lazlx\nayafxml (79)\nbnvjmae (7)\nogpka (80)\ngnrqrsj (2189) -> ortcrq, upbmqk\nrxefab (131) -> vcaekf, sqnfwo\npgpnvo (931) -> eahos, kcreb, lwefm, bbdimns\nbphrvm (64)\ndoazn (211) -> siswh, hhvqa\nsawqp (32)\nmwdvbr (68)\nmtboq (76)\ndxcpj (93) -> afcgdxg, kzwgln, wkydaz, spkeqv, udxegjf\nlyhxuh (22)\niuovz (88)\ncsear (1969) -> fnijmph, mgzotal, evmblgk\nrojhup (7)\nebtbnei (31)\nlhnevgo (269)\nzibbm (85)\nnrmvc (37)\ntxxpej (280) -> actggv, krqxe\nlhvtmoo (130) -> icncbl, zbtck\nwgwkss (80)\naawxzzs (22)\naarioi (79)\ncabsaub (60)\notymybu (223) -> ddkgzi, viafs\ncbgfg (58)\nwcinck (20) -> ziwkz, wfeupmd, drszzbe, mgeseyn, xasioks, xtjrkv\norkcq (65) -> iujqo, ehdax\nokfcek (97)\nybbrr (247)\niatmtm (55) -> lwxts, mqecf, tuhxr\nyyxmp (80)\nysvjxvz (78)\nbirahww (74)\nmxxfu (57) -> qdovgra, ywlrls, wahwi, mzjwcds, axrojbs, urigx\nxbqpjo (98)\nkqmhotc (94) -> rkuyxrc, wfjgqqm, xdylc\nqwtodu (71)\nqdxteam (61) -> ybbrr, frrvvai, ncjhpa, onuxzz, jvepbal, qznpwb\nfbiqxqk (59)\nrokie (9708) -> vmgqltz, qdxteam, srvwd, qvbuj, pgpnvo, hxjhcuc\novmvvkl (24) -> tvhgbau, exgsmmj, uwvbon\nqnxnatu (92)\nhrkswsk (44)\nndodv (296)\nkoemv (92)\nhfqjj (37)\nyexyj (80)\nfhlul (56)\ndzzbvkv (64)\ngmhxee (74)\njbgqlat (65)\nqclpa (84)\nindgw (91)\nkrqxe (65)\nlmmeg (26) -> ummcw, zqhdiwz\nbgmwpam (68)\nwpfbdof (151) -> sbutyr, klgsk\nqznpwb (153) -> vfmwzb, haicg\nhdpemqh (168) -> txxpej, pwvmmda, gadyi, mvhqou\ngpfaupm (13)\niqfmvz (67)\npdcaqbr (97)\nqfkow (64)\nexhxs (89)\nzebdkqz (44)\nrrtqyew (191) -> zbxakfn, ajfkd\nukrki (39)\nhvacjk (69)\nudfuty (32)\nmrgccl (85)\nuzily (82) -> swscfel, apzabs\nlxffhxk (1245) -> bfqba, cpxgct, rouiui, qyypm\njfngjl (86)\nceevpgx (47)\nsziwpzi (65)\npqmye (57)\nphkvcix (90) -> nubay, jaamgi\ngxcnp (27)\nwmwzhjg (73)\nmiuvc (283)\nnvtbk (1775) -> srgua, ckcaugr, xrapmvb\nzfthi (60)\ninezd (42)\nirzuowk (90) -> ayqgp, zruqij, oqbet, fdckzry\nzuxvjpc (62) -> mbunh, mgvoh, bfxezgb, sxxhmpb\nwmyvz (59)\ntqjpfzx (47) -> gjupqe, lwhev, bxhjjd, fmquyhw\nxhwfcu (75)\ntnltvzk (90) -> cevkjvr, hrmpq\nuhepxt (60)\nsjixg (25)\nkuaeh (33)\nuwvbon (79)\njzoue (94)\nhdspavt (60)\nkosgqpu (50)\nmznkfco (79)\nxfanpad (60)\nzcpyr (81)\ngutifk (228)\nscipnb (53)\nejvaoj (59)\nybuhf (50)\nbpmkexj (166) -> mbokr, ytbtswy\nogafygg (39)\nfooowuf (42)\nyiwdaj (86) -> iwajy, aftsom\nhoelsa (64)\ncjvdngb (91) -> qedkzuz, vtamjj\nrsqexkv (70)\nftqtzxk (43)\nazgjimy (92)\nbochc (39)\nqfsue (35)\nobjqgkm (146) -> tsiuz, glguoq\ntatjry (47)\ntcpujhx (55)\nnnvpkf (56)\ngatdr (89)\njcmviuv (37)\npzhyoh (3960) -> bkset, bfwbkxq, zsdvfrk, wrobpcw, ffxnegs, ifntl\nsvyojyu (60) -> qslgo, ukqcayx\nsxbusu (73)\njtikaai (194) -> yukoxaw, qftqq\nnkgmg (88)\nzolmsue (66)\nziyyvk (60) -> yuypmb, ctoxz, dcwpsvy, mxrfq\nbgcjrf (80)\nqlqqlq (350)\nnpsza (74)\neahos (19) -> ywavdk, iqfmvz\ncpxgct (14) -> tabzzo, svyojyu, pynxen, idooz, nzorg, zudqkt, fsvkj\nnxrkz (1541) -> gutifk, avqjqdf, mgyfdm\ntwzgms (43)\nuwizfa (88)\ntiush (60)\ncqpns (123) -> tfnem, kqguihx\nnecmih (10) -> dppzdx, zvelptp, tpsgt\nehxkgh (172) -> bthswyg, lbojqfo\nyxoqwg (80)\nemfbheo (85) -> uspvnv, oermd\nsiisskc (13)\nicccxzg (71)\npjvpqmg (64)\ndxxty (64884) -> ljugvh, gyyqk, pzhyoh\nneladb (11)\npolrzc (59)\nsnvqyqb (66)\nlebqr (60)\nshfjyzk (68)\nacdkw (1907) -> apzjw, ialtabg, cjvdngb\nxdylc (55)\nhknzmvs (93)\nobrwb (64)\nwerriw (13)\njjjfkf (19)\nzqckoxe (118) -> vynvu, zgnwz\nmgvoh (8)\noxewutr (97)\nqqydcts (62)\npjkwlmk (56) -> etdofb, qqydcts\nkzwbhrg (55)\ncgzyc (669) -> bqtppn, rwjzc, bwylliz, rrkhcl\nsltrdk (88) -> qwtodu, rpkpa, kddchk, xirqz\naqjkcss (77) -> rfaxua, nsggol, uxlcvt, jwpqgy, tjobe, ovrkpd\nxagwh (99) -> sdigtox, pocxfrt, iancjuu, iefyz\napjxafk (1513) -> rznyr, oamrbi\nuturjs (85)\nqwxrsa (261)\ncgjula (2020) -> lhvtmoo, yiwdaj, biwdu\nyakzm (16)\nejtoqaj (1426) -> whggku, ktehtif, wpfbdof\neoaprcr (93)\notaty (141) -> ydpihb, ouabc\nrjijdre (17)\natfpsi (196) -> qoqydb, vgvvr\nqjazr (21)\npetluuh (67)\nxdupyte (19)\nrpkpa (71)\naytjryx (25)\npfmor (80)\nrfbdpc (66) -> payoa, ymfosm, ndodv, thutxib, objqgkm, gjjfju\nkkciirc (71)\nhfnijbd (234) -> qarjx, olhuxt\nmrvdvga (54)\nvwhynu (20)\nnnsyc (59)\nrlwvuj (280)\nvtono (37) -> gdutjjl, eqahcc\njdjaem (74)\nhgcxyx (13)\nmkjvhl (282) -> neladb, tsrrzuc\ncmeqx (521) -> uzprmq, xjmrcc, qlqqlq\nfffxc (74)\nsbutyr (6)\njikzxd (50)\nzvildgh (1079) -> wtoive, rbucosf, eoasnfq\nunfgdb (91)\nnpdwg (80)\nftdkas (33)\newdpntl (66)\nakrgdse (63)\nvczudlu (17)\nablvgzq (58)\nkbout (79)\naqogxi (29)\nigfjvkm (265)\nrkbtnzd (40)\njatvkwy (92) -> kqiraxg, vsyuckp, zwjds, mrvdvga\nmjuwde (888) -> cbqebx, kihxgg, zjqbfd\nytbtswy (57)\nrugzyaj (16029) -> apjxafk, jngcap, wrtyhxg, hblcbb\nfuega (70)\nlejoaru (64)\nzvelptp (28)\nmdfbhs (5185) -> miymiit, jjgem, gpzaa\nxwifd (7225) -> rfbdpc, qqduoo, uagezb\nbxhjjd (172) -> yacaqwf, ngksxux\nxduga (88)\nrwbhl (183)\ncpazla (101) -> ayypg, kjzsi\nttmei (19)\nhblcbb (5) -> qwxrsa, ovmvvkl, orkcq, otymybu, sjxbk, frqtkkr\nlzbbin (250) -> ujzofuy, urwgjd\nbgctgn (34)\nuaqik (15)\nkvpztt (93)\nzeopgv (312) -> pgznzly, ixwyi, tefcd\noyfob (81)\nyhzwdu (28)\nxwmnaj (41)\nngksxux (82)\nbrmtxo (300)\nkdujkg (12)\ncjlxgf (165) -> bsoef, rkbtnzd\ntefcd (13)\njsniger (680) -> lycpdcu, iihzs, aubhuwo, xucelzn, qykoae\nthutxib (138) -> mblvffb, zukgdrx\nnpfkpts (90)\nyqbkjg (51)\ntsiuz (75)\notvvje (43)\nboxvu (18)\netnuzv (27)\nfkmccg (32)\nzzxlo (2220) -> zhiai, oqhwa, irzuowk\nhaicg (47)\nveqahi (50) -> yugjkuz, ncaoc, hfjhadi, cmzoogc\nuystf (75)\nwqxcn (292) -> ddrrgp, sxvlfn, ipmbqts\njlbhafs (27)\nlvuzab (74)\nhrfyodg (84)\napctfnv (246) -> baygmx, zacywmu\nwafjawl (56)\ndlsss (88) -> mijxl, voonmio\nnlrobhq (87)\njzdmjdf (1849) -> aaaak, necmih, fmifd, kowco\nyzivqv (32)\ncufudi (97)\nzwjds (54)\npizkx (21)\nfbdfh (73)\ncwvkon (193) -> cepqh, jjjfkf, xdupyte\nwqgpm (56)\nvopeoj (14) -> sgqaiyz, ysvjxvz\nzqtok (151) -> fhgnht, fooowuf\nfugeht (89)\nmgyfdm (60) -> mvvgro, hrfyodg\nwqdvql (39)\nogiie (573) -> hfnijbd, cxokosi, jtikaai, ffgoyk\ntgqpp (89)\nfdaddso (15)\ncmzoogc (58)\ngjjfju (270) -> kndcyxb, cpmcrx\nwowkfnh (64)\nlwefm (115) -> ageyuq, jbaazop\nqykoae (61) -> cbgfg, dyfhy\nipeig (98)\niyjcoy (63)\nomzpkv (23)\nkqguihx (48)\nqrtwjv (37)\nsgqaiyz (78)\ngzdxgvj (64)\nwfeupmd (65) -> pdjnnzd, mrgccl, uturjs, yfszfef\nvmgqltz (841) -> ecabcm, vigvho, ppfyonm\ntxvuv (5)\nzfcylzq (113) -> ocbxx, kofvzz\nvigvho (76) -> vtnpx, hjdms\nnjrzjdt (171)\niyflfx (90)\nspkeqv (1828) -> qbkipp, bendlfs\ndqiyfw (21) -> mliwyi, kvpztt, oyjtku\nnufpcxh (71)\nppbevc (13)\nbljfcim (80)\nhjdms (79)\nmcfrv (19)\nzruqij (58)\ngmurq (89)\nzyqqzou (78)\npyocxtt (27)\nakrsjfc (64)\nnzorg (102) -> bdukt, kkciirc\nvobfi (734) -> lbfgh, wfbuzbg, kklix, hpsxqdm, lhtzrh, cpazla, skhmac\nzugxr (84)\nldwhpl (324) -> takkbk, thneyz\nkzwgln (1217) -> evwne, lrvxyg, hllzej\nheuyaxx (2337) -> iatmtm, pabgfh, oryrq\nkzjkjz (17)\nykmej (92)\nsqfopc (33) -> mavbgo, uucyyr, nyjmiyq, tygst\nqcpuch (270)\nqcolnc (11) -> ewdpntl, zolmsue, lunbob\ntfxyjz (87)\nfiqzxhc (38)\nhvhtokr (95)\nledgpb (132) -> kqltx, wivwqm\nbonnse (30)\ndcwpsvy (98)\nxjmrcc (268) -> yucwtc, ilueo\nbzkwsro (49)\nzziyhz (18)\nqoqydb (66)\nubrrbmk (87) -> pkglsge, gjorp\ncgnibii (188) -> pqvid, uiasar\nsxvlfn (23)\ngqgewi (2538) -> ndxuv, egulpbe\nqosqq (47)\njkczp (37)\npxhbe (11)\nvpjmvzd (37)\nrvjzxtg (86)\npfzqe (89)\nuvhmzj (114) -> bphrvm, lgamzp\ngklur (85)\nwbbfe (37)\nwkumzkr (1049) -> nxtyiha, modzqb\npyhqixj (63)\nohtzuf (87)\nlsycscb (26)\nbdsibf (87)\ngzter (49)\nogelzdv (87)\nfstzdn (97)\nebktv (146) -> gpfaupm, cduzde\niinql (28)\ntdurwbh (58)\nhnvybq (268)\nsfxsn (75)\njgdumgz (87)\nzqhdiwz (96)\nrznyr (33)\nouqwmnj (265) -> jdbub, evqrr\ntiuag (62) -> xhbjag, bmehz\nfdckzry (58)\nhdkpuyx (86)\nhemnmbr (16) -> ukrki, mgsasl\nrupdbwl (43)\nbbdimns (57) -> upftju, iracqt\nipdbccy (34)\nfbrvfk (79)\nhueqfk (85)\nbxrkfwo (67)\nfwafvkf (40)\nnsbli (47) -> hpanc, xjafd, uqjmbb, ycnih\nifhpy (79)\nfneqe (1219) -> vmatvgx, bofjde, hhnpg\nmliwyi (93)\nutqxb (37)\nfvivhx (75) -> nwlyt, dyxcd\nwhggku (97) -> vomrnc, ceqfbbl\nkndcyxb (13)\nynwpoz (785) -> raioiq, yyblsz, rxuqpgb\nhrrampl (27)\nkkftjia (87)\nrvxed (122) -> rktkzfw, qfsue\nmiauii (66) -> kpjxln, icrnru, dqiyfw, brmtxo, pkcakwk\nbkset (857) -> brfocu, thvjlgo, urhwog, apctfnv\nnhxfu (35) -> lwufmc, gatxz\nskhmac (101) -> dbnstqf, wafjawl\nbdwswow (65)\nlgoak (70)\nmdrob (51)\nfsixon (27)\nhcyohc (85)\nkihxgg (44) -> awhwxdm, sbgtiqe\nhdhvzi (1759) -> kzhpyr, apvfi\nbwylliz (110) -> kwvybk, ftexc\nxijwk (841) -> bsmxm, xrise, uzjoys\nxkpulvc (93) -> fbvvrqt, zcpyr\nxhbjag (76)\nazrpi (92)\nlxxfgli (49) -> nlrobhq, ogelzdv, tfxyjz, bdsibf\nqedkzuz (45)\nbmehz (76)\nexgsmmj (79)\nijcxfx (136) -> jbgqlat, bdwswow\nnsvrfae (71)\noffas (58)\nipofw (15)\nmatcdld (35)\ngjorp (93)\nbofjde (152) -> jcuiffa, vvkbav\nyxqesmi (172)\neisrj (90)\npjmci (59)\npalqky (60)\naipmq (41)\nripgc (44)\nehdax (98)\njtlhia (749) -> tiuag, bdbxp, dlsss\nuucyyr (91)\ndtqbtvx (223) -> izyjved, etnkepp\nyhlbg (41)\nkwvybk (96)\nfhgnht (42)\nummcw (96)\nkhkuxc (1254) -> qqhjlu, gekcx, vrajpg, emppnct\nnwlyt (87)\ntxnzg (74) -> lcfundi, tifkr, imfog, imbpvgl\ndkzitf (20)\nbdbxp (80) -> fcvpdiz, bxrkfwo\ndegnsd (177) -> eetxll, jkczp, ghzqyv, kictlpo\nzudqkt (142) -> fszrgv, wwobe, jbjkp\nzjcdwr (249) -> bqcizg, saiyjff\nsjthmr (76)\nkryoh (144) -> jcmviuv, hfqjj\nghuoa (78)\nuitef (77)\ncjkoxak (340) -> sowzlz, ttmei, lajyaur\npczkz (88)\nitlsv (55)\nnwztmzp (63)\ntsrrzuc (11)\nrxrzt (65) -> krembdy, zrbkrdx, aipmq\nfrqtkkr (185) -> qecgvu, lbjuqcd, mcfrv, kwqcbe\nmdrir (12)\nvytdgko (97)\ntkeoe (865) -> wzcgi, awsphe, ifhpy\norwbp (96) -> ecjujqu, iccpjfn\nckexdc (10)\npopymuq (35)\neuiig (166) -> ablvgzq, tdurwbh\nibjbozh (895) -> ijcxfx, nmlykny, fshvy, nutlr, yotlucw\nidszh (34)\ntfnem (48)\nkqrjpgl (42)\newsrnsd (90)\nrnsxz (9718) -> pvzyops, zfjpii, luccp\navqjqdf (50) -> dilefzx, dulpw\neuqvd (42)\ndulpw (89)\nnppdvs (40)\ngncvcwi (104) -> pfmor, yyxmp\nfmquyhw (188) -> hwqvzw, huspq\nhpgktb (60) -> hcgbmwl, tiush\niyxkzat (49)\nseyed (86)\nzzwtuu (260) -> unzzng, ebsxx\nnfvsrpa (876) -> kwwhb, blome, otaty, dtqbtvx\nmnwhky (1339) -> hqccsb, ldflo, rgfur, rxrzt\nkebff (242)\ncogovv (74)\ntakkbk (57)\nyyswun (98)\necjrblb (68)\nycawl (224) -> vpjmvzd, bzlgar, jtujnwo\ndppzdx (28)\nalcpfsx (136) -> siyuvy, nowyhln\ndfdgoj (153) -> aufym, pfxrf\njcuiffa (56)\nyjyipdp (66)\nilueo (41)\niazte (201) -> tsetywu, zkzefwh\ndiavsdh (326) -> wladmn, zudqxa, ajpcyv\nllofnny (66)\nkitsxb (59)\nkqltx (74)\nklzfl (93)\ntpdcb (84)\nafcgdxg (1202) -> qcpuch, njmrq, tnltvzk\ngnwjseo (600) -> pkxhxdz, jbfzjha, ixdcgsa, degnsd, fwtfkp\nyqnbqgc (178) -> dkzitf, zybvpry\nialtabg (21) -> jbtzoy, sqincn\nuorpbn (353) -> ygbyt, afjmzb\njdhiflw (60)\nqpwfl (11)\nxasioks (405)\nlajyaur (19)\najpujs (271) -> zxzkl, dkgsvl\novrkpd (147) -> sdzoy, mdrob\nsveuu (55)\njtvntr (83)\npvgay (69)\nboiic (80) -> ipofw, ggjmhab, mwjtydb\nsjcbxp (59)\nuvzwdly (20)\nsbgtiqe (91)\nluzcpkn (43)\nndxuv (80)\ntkejpfe (13)\nggjmhab (15)\nszvrql (46) -> cnknlru, zrydf, cvvtz, uwiza, gikqie, lknchr\nlvkpx (233) -> wmyvz, nnsyc\nbhzbv (28) -> azgjimy, frlmoih, azrpi\ncujhtj (193) -> qhbotj, qnsnc\nvmatvgx (90) -> uaavvo, ezztp\npvpyhb (81)\nmdpcfvu (176) -> gyktq, yyswun\naubhuwo (99) -> yyqleqa, nmdhmy\nwgglzpb (191) -> gmurq, hkewsbw\namaeuv (58)\nijleirw (172) -> jikzxd, yeewxiw, jhcurc, kosgqpu\ntvhfxfo (105) -> wnzdcc, bszcup\nkzvwk (74) -> ujogppt, appkqpe\nqgxcbt (68)\nipmbqts (23)\nwoeoaa (59)\nyfszfef (85)\nickxyrm (87) -> hrxfpx, owlyge\nmjlmuca (41)\niracqt (48)\ndtyxosg (84)\nvyaoad (83) -> tojpm, euaceg, zhffrzu\njemmk (47) -> mwdvbr, shfjyzk\nviafs (19)\niefyz (39)\nwkydaz (332) -> orwbp, xhhfsuw, ledgpb, rlwvuj, bpmkexj, diduy\nzhiai (228) -> qosqq, ceevpgx\naydmhhv (87)\nvtamjj (45)\negabi (79)\nzgnwz (87)\nkvtvmi (39) -> fpmwz, oeaqbvl, oipjwtz, usevgds, vwtmps, kryoh, gkzeqaw\nsszzop (89)\nuaavvo (87)\nxtvyh (83) -> pczkz, xydxl, xduga, gycde\nfpgciql (51)\nynkkomw (279) -> iyjcoy, ijiqjtf\nyirkbjn (1872) -> wjjar, ldwhpl, kcimi\npaqvyfa (58)\nkhbvu (51)\njvpgl (20)\nsxslizl (86)\ngbpcav (77)\nkjqiop (40)\nulxsa (115)\nnhzmidl (27)\nnchjk (37)\nyokqfgn (94)\nqwdppks (95)\nfnijmph (90) -> yqbkjg, ykvtr, fpgciql\nxucdiz (6) -> kkyfjh, cxjyxl\nftexc (96)\nkrembdy (41)\ngzykr (1135) -> lejoaru, qfkow, wowkfnh, pjvpqmg\nsrrxb (81)\nylwniqh (68)\nusuujhq (46) -> pkotpki, seyed, jgkmy\nilfgats (6031) -> mxxfu, vrjea, mnwhky\nurxxlfo (84) -> juakl, bwywt\nfsfuluo (34)\nstaqwo (8)\nynirne (13)\nzyonam (217) -> sofxmjx, ytpiey\nornybn (37)\njvepbal (79) -> cqiipxn, qclpa\ngoicjt (41)\nbfpvsfz (39)\nzbxakfn (9)\ncqdtav (22)\ncufaveh (20)\nzxqix (157)\nzudqxa (42)\nfcvpdiz (67)\nkzhpyr (59)\ncuwqi (104) -> jotxc, teuzi\nmdopg (44)\npyntdrr (320) -> lbiigt, aeliqqs\nouabc (46)\nwnzdcc (56)\nwvkaie (80)\naxrojbs (239) -> aytjryx, xbpqmua, sjixg, lytukj\nlcyuk (93)\ntdnzc (22)\nwrobpcw (1196) -> fujvp, gfuxooq, crkapwa\nhyfswg (1414) -> rcywun, kqmhotc, xvwqzt, bbsomm\nyugjkuz (58)\ntokvgmd (91)\nyyqleqa (39)\npmfpitp (33)\nnhxmab (24)\nhwqvzw (74)\nhntdp (90)\nnercz (33)\nkvjqli (72) -> tpdcb, edoftkj\nzdrfiw (80)\nviklkmp (19)\nevmblgk (183) -> yycux, buifcn, uaqik, fdaddso\nwzcgi (55) -> hzsgvc, staqwo, fgxst\nbaygmx (12)\nmxscf (62)\noqhwa (186) -> gcbvf, bgmwpam\nsflwom (253) -> uvzwdly, pjkjcy, rcongvf\najrcal (83)\nyqyyoj (33) -> lftlc, npcyutn\ntpsgt (28)\nebsxx (22)\naceiy (13)\njwlaj (1031) -> qjuud, tdtznh, cuaect\nhvefi (15)\nnxtyiha (30)\nmzjwcds (229) -> icqsww, pitdti\nndxim (6)\nvomrnc (33)\nvfmwzb (47)\njidxg (64)\naqtml (293)\ncevkjvr (90)\nlycpdcu (5) -> rvjzxtg, ovysqnt\nthmlk (34)\niujqo (98)\nsynjm (51)\npaqlttl (65)\nkklix (25) -> jzoue, yokqfgn\nusevgds (44) -> aydmhhv, kkftjia\ntqlentr (214) -> gfxnuuk, thmlk")

(def supporting-program-re #"^([a-z]+) \((\d+)\) -> ([a-z, ]+)$")

(def standalone-program-re #"^([a-z]+) \((\d+)\)$")

(defn parse-supporting-program-line
  [line]
  (if-let [matches (re-matches supporting-program-re line)]
    (let [[_ tower weight subtowers-str] matches
          subtowers (str/split subtowers-str #", ")]
      [tower {:weight (core/parse-int weight) :subtowers subtowers}])))

(defn parse-standalone-program-line
  [line]
  (let [matches (re-matches standalone-program-re line)
        [_ tower weight] matches]
    [tower {:weight (core/parse-int weight) :subtowers []}]))

(defn parse-line
  [line]
  (if-let [supporting-program (parse-supporting-program-line line)]
    supporting-program
    (parse-standalone-program-line line)))

(defn all-programs
  [program-defs]
  (->> program-defs
    (map first)
    (into #{})))

(defn all-subtowers
  [program-defs]
  (->> program-defs
    (map #(get-in % [1 :subtowers]))
    (reduce into #{})))

(defn base-program
  [program-defs]
  (first (set/difference (all-programs program-defs)
                         (all-subtowers program-defs))))

(defn program-tree
  [program-defs]
  (into {} program-defs))

(defn subtowers-of
  [tree program]
  (get-in tree [program :subtowers]))

(defn weight-of
  [tree program]
  (get-in tree [program :weight]))

(defn aggregate-weight
  [tree tower]
  (let [program-weight (weight-of tree tower)
        subtowers (subtowers-of tree tower)
        aggregated-subtrees (reduce aggregate-weight tree subtowers)
        new-subtree-weights (map #(weight-of aggregated-subtrees %) subtowers)
        new-weight (reduce + program-weight new-subtree-weights)]
    (assoc-in aggregated-subtrees [tower :weight] new-weight)))

(defn unbalanced
  [subtowers subtower-weights]
  (let [freqs (frequencies subtower-weights)
        diff-weight (core/reverse-lookup freqs 1)
        subtowers-to-weights (map vector subtowers subtower-weights)]
    (core/reverse-lookup subtowers-to-weights diff-weight)))

(defn seek-misweighted
  ([tree base-program]
   (let [subtowers (subtowers-of tree base-program)
         subtower-weights (map #(weight-of tree %) subtowers)
         unbalanced-program (unbalanced subtowers subtower-weights)
         unbalanced-weight (weight-of tree unbalanced-program)
         other-weights (first (filter #(not= unbalanced-weight %) subtower-weights))
         expected-diff (- other-weights unbalanced-weight)]
     (seek-misweighted tree unbalanced-program expected-diff)))

  ([tree program diff]
   (let [subtowers (subtowers-of tree program)]
     (if (= 2 (count subtowers))
       (let [[program-a program-b] subtowers
             [weight-a weight-b] (map #(weight-of tree %) subtowers)]
         (cond
           (= weight-a weight-b) [program diff]
           (= (+ weight-a diff) weight-b) (seek-misweighted tree program-a diff)
           :else (seek-misweighted tree program-b diff)))
       (let [subtower-weights (map #(weight-of tree %) subtowers)
             unbalanced-program (unbalanced subtowers subtower-weights)]
         (if-not unbalanced-program
           [program diff]
           (seek-misweighted tree unbalanced-program diff)))))))

(defn rebalanced-weight
  [input]
  (let [parsed-defs (map parse-line (str/split-lines input))
        base (base-program parsed-defs)
        regular-tree (program-tree parsed-defs)
        aggregate-tree (aggregate-weight regular-tree base)
        [misweighted-program diff-weight] (seek-misweighted aggregate-tree base)]
    (+ (weight-of regular-tree misweighted-program) diff-weight)))
